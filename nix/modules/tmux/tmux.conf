set -s default-terminal "tmux-256color"
# Describe outer terminal for overrides!
set -as terminal-overrides ',*:Tc'

set-option -g focus-events

set-option -g default-shell $SHELL

set-option -g history-limit 900000

set-option -g status-position "bottom"

# Set ` as prefix. Type ` twice to actually type `
unbind c-b
set-option -g prefix `
bind ` send-prefix

# set is an alias for set-option
# set -w is equivalent to set-window-option
set -wg mode-keys vi
set -wg main-pane-width 130
set -wg main-pane-height 30

set -sg escape-time 0

set-option -g status-interval 5

set -g automatic-rename on
set -g automatic-rename-format '#{b:pane_current_path}'

if-shell "uname | grep -q Darwin" "bind-key -T copy-mode-vi Y send -X copy-pipe 'pbcopy'" "bind-key -T copy-mode-vi Y send -X copy-pipe 'xclip -sel clipboard'"

# -------------------------------------------------------------------
# Key bindings
# -------------------------------------------------------------------

# copy-mode
# -T to specifiy key table, in this case copy-mode-vi (copy-mode) is for emacs
# -X to send to copy mode
bind -T copy-mode-vi y send-keys -X copy-selection
bind -T copy-mode-vi v send-keys -X begin-selection

# Window movement
bind bspace previous-window
bind space next-window

# choose-*
bind T choose-tree
bind W choose-window
bind B choose-buffer

bind C new-session

bind X kill-pane -a
# kill without confirm
bind x kill-pane

# resizing
bind L resize-pane -R 10
bind H resize-pane -L 10
bind J resize-pane -D 5
bind K resize-pane -U 5

# join marked pane here
bind M-j join-pane

# rotate windows
bind O rotate-window

# last window
# conveniently, ; is switch to last active pane and is a default
bind "'" last-window

# prefix |
bind | split-window -h -c "#{pane_current_path}"

# prefix -
bind - split-window -c "#{pane_current_path}"

bind c new-window -c "#{pane_current_path}"

# prefix G (Goyo) toggle status bar
bind G set status

# Moving windows
bind -r > swap-window -t :+
bind -r < swap-window -t :-

# Layouts
bind / next-layout

# Pane-movement
bind h select-pane -L
bind l select-pane -R
bind j select-pane -D
bind k select-pane -U
bind tab select-pane -t :.+
bind btab select-pane -t :.-

# Reload ~/.tmux.conf
bind R source-file ~/.tmux.conf \; display-message "Reloaded!"

# -------------------------------------------------------------------
# Decoration (256-color)
# -------------------------------------------------------------------
set-option -g status-justify left
set-option -g status-left '#[fg=colour7] #S #h'
set-option -g status-left-length 30
set-option -g status-bg default
set-option -g status-right ' #[fg=colour7] #(date "+%a %b %d %H:%M") '

set-option -g pane-active-border-style fg=colour2
set-option -g pane-border-style fg=colour7
set-option -g pane-border-status bottom
set-option -g pane-border-format "#{b:pane_title}"

set-window-option -g window-status-format '#[fg=colour7] [#I] #W #F'
set-window-option -g window-status-current-format '#[fg=colour2] [#I] #W #F'
